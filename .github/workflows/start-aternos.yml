name: Start Aternos Server

on:
  workflow_dispatch:

jobs:
  start-server:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@v2
    
    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: '3.x'

    - name: Install dependencies
      run: |
        pip install python-aternos

    - name: Start Aternos server
      env:
        ATERNOS_USERNAME: ${{ secrets.ATERNOS_USERNAME }}
        ATERNOS_PASSWORD: ${{ secrets.ATERNOS_PASSWORD }}
      run: |
        python -c "
        from aternos import Client
        import os

        USERNAME = os.environ['ATERNOS_USERNAME']
        PASSWORD = os.environ['ATERNOS_PASSWORD']

        aternos = Client.from_credentials(USERNAME, PASSWORD)
        servers = aternos.list_servers()
        server = servers[0]
        server.start()
        "
